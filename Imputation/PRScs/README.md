# PRS-CS: A GReX imputation model infers posterior eQTL effect sizes under continuous shrinkage (CS) priors 

<!-- ## Example Data -->

## Usage:

```bash
python3 OTTERS_PRScs.py \
--OTTERS_dir=PATH_TO_OTTERS \
--in_dir=INPUR_DIR \
--out_dir=OUTPUT_DIR \
--chrom=CHROM 
[--out_file=OUTPUT_FILE --a=PARAM_A --b=PARAM_B --phi=PARAM_PHI --n_iter=MCMC_ITERATIONS --n_burnin=MCMC_BURNIN --thin=MCMC_THINNING_FACTOR --thread=THREAD --seed=SEED]

```
Mandatory parameters:

 - PATH_TO_OTTERS: The directory of OTTERS source code

 - INPUT_DIR: The directory and filename that saved the required inputs generated by OTTERS. Please see [here](../prep/README.md) for more information about how to use OTTERS to generate inputs.

 - OUTPUT_DIR: Output directory of the posterior effect size estimates.

 - CHROM: An integer for the chromosome of tested genes.  

Optional parameters:
 
 - OUTPUT_FILE: Output filename of the posterior effect size estimates. Default is PRScs.txt.

 - PARAM_A (optional): Parameter a in the gamma-gamma prior in the continous shrinkage prior proposed by PRS-CS. Default is 1. 

 - PARAM_B (optional): Parameter b in the gamma-gamma prior in the continous shrinkage prior proposed by PRS-CS. Default is 0.5.

 - PARAM_PHI (optional): Global shrinkage parameter phi. If phi is not specified, it will be learnt from the data using a fully Bayesian approach.
                         This usually works well for polygenic traits with large GWAS sample sizes (hundreds of thousands of subjects).
                         For GWAS with limited sample sizes (including most of the current disease GWAS), fixing phi to 1e-4 or 1e-2,
                         or doing a small-scale grid search (e.g., phi=1e-6, 1e-4, 1e-2, 1) to find the optimal phi value often improves perdictive performance.

 - MCMC_ITERATIONS (optional): Total number of MCMC iterations. Default is 1,000.

 - MCMC_BURNIN (optional): Number of burnin iterations. Default is 500.

 - MCMC_THINNING_FACTOR (optional): Thinning of the Markov chain. Default is 5.

 - THREAD (optional): Number of simultaneous processes to use for parallel computation. Default is 1.

 - SEED (optional): Non-negative integer which seeds the random number generator.

## Example:

```bash
input_to_imputation=Exp/Inputs
output_dir=Exp/Outputs
chr=4

python3 ${OTTERS_dir}/Imputation/PRScs/OTTERS_PRScs.py \
--OTTERS_dir=${OTTERS_dir} \
--in_dir=${input_to_imputation} \
--out_dir=${output_dir} \
--chrom=${chr} \
--n_iter=100 \
--phi=1e-4 \
--thread=2
```

## Output:

Exp/Outputs/PRScs.txt: the estimated eQTL weights

  - | CHROM | POS | A1 | A2 |     TargetID    |  ES  |
    |:-----:|:---:|:--:|:--:|:---------------:|:----:|
    |   1   | 100 |  C |  T |     ENSG0000    |  0.2 |
 


